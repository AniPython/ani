{% extends 'crawler/includes/crawler_base.html' %}

{% block 说明 %}
    提供下载功能的<code>django</code>后端代码片段
    <div>
        <div class="highlight rounded-3">
                                <pre class="prettyprint lang-python border-0">urlpatterns = [
    ...
    path('crawler/6/download_file',
          crawler6_download_file,
          name='crawler6_download_file'),
    ...
]

def crawler6_download_file(request):
    """
    文件下载
    """
    dir_ = Path(__file__).resolve().parent
    file = open(dir_ / 'apps.py', 'rb')
    response = FileResponse(file)
    response['Content-Type'] = 'application/octet-stream'
    response['Content-Disposition'] = 'attachment;filename="apps.py"'
    return response</pre>
        </div>
    </div>
{% endblock %}


{% block 爬取内容 %}
    下载文件:
    <a class="btn btn-primary" href="{% url 'crawler:crawler6_download_file' %}">
        apps.py
    </a>
{% endblock %}


{% block 方案1标题 %}
    方案1:&nbsp<code>requests</code>
{% endblock %}


{% block 方案1详情 %}
    <p class="card-text mb-1">
        使用 chrome 浏览器 右键 -> 检查<br>
        来查看获取文件的地址<br>
    </p>
    <img class="w-100" src="/media/img/crawler6_download_file.png" alt="">

    <div class="mt-2">
        <div class="highlight rounded-3">
            <pre class="prettyprint lang-python border-0">{{ code_crawler6_1 }}</pre>
        </div>
    </div>
{% endblock %}


{% block 方案2标题 %}
    方案2:&nbsp使用&nbsp<code>selenium</code>&nbsp+&nbsp<code>Firefox</code>&nbsp+&nbsp<code>geckodriver</code>
{% endblock %}


{% block 方案2详情 %}
    1. 安装&nbsp<code>selenium</code>
    <div>
        <div class="highlight rounded-3">
            <pre class="prettyprint lang-bash border-0">$ pip install selenium</pre>
        </div>
    </div>

    2. 安装 Firefox 浏览器<br><br>
    3. 下载&nbsp<a href="http://npm.taobao.org/mirrors/geckodriver/">geckodriver</a>
    (需要解压), 并放到当前Python环境变量的其中一个路径下<br>
    例如: /Library/Frameworks/Python.framework/Versions/3.9/bin/<br><br>

    4. 代码
    <div>
        <div class="highlight rounded-3">
            <pre class="prettyprint lang-python border-0">{{ code_crawler6_2 }}</pre>
        </div>
    </div>
{% endblock %}


{% block 方案3标题 %}
    xxx
{% endblock %}


{% block 方案3详情 %}
    xxx
{% endblock %}


{# 不显示方案2 #}
{#{% block 方案2 %}{% endblock %}#}

{# 不显示方案3 #}
{% block 方案3 %}{% endblock %}
